{# Logged in User PROFILE PAGE #}
{# Default profile and album page that logged-in user sees #}
{# Authentication handled in views.index #}

{% extends 'base.html' %}

{# displays new/uncategorized memes to profile for categorization#}
{% block content %}

<div id="albums_container">
  <div id="albums_header_container">
    <div id="albums_header"> 
       Albums
    </div>
    
    <div style ="clear:both;"></div>
  </div>

  {# Insert flash message when inviting friend #}
  {% if messages %}
  <ul class="messages">
      {% for message in messages %}
      <li{% if message.tags %} class="{{ message.extra_tags }}"{% endif %}>{{ message }}</li>
      {% endfor %}
  </ul>
  {% endif %}
    
  {# Displays existing experiences #}
  <div id="create_album_container">
      <div id="create_album">
        <div id="input_field_container">
        <form action="{% url add_experience %}" method="post">
          <!--<input placeholder="Album Title" size="6">-->
          {% if addexperienceform.title.errors %}
            <p class="errors">Please correct the errors below: {{ addexperienceform.non_field_errors }}</p>
          {% endif %}
          </div>
          {% csrf_token %}
          {{ addexperienceform.title }}
         <div id="profile_button">
         <input type="submit" value="Create Album" />
         </div>
        
        </div>
      </form>
    </div>
  {% if experiences %}
   
    {# FOR YC APPLICATION -- message #}
    {% if yc %}
      <div class="text-info">Hey YC, thanks for checking out our demo!</div>
    {% endif %}


	<span id="albums_display_container">
    {% for experiences in experiences %}
		  <div id ="albums_display">
			<span id="hide_text_container">
			  <span id="albums_info">
				<a href="{% url webapp.views.show_experience experiences.pk %}" class="experiences_list" id="{{ experiences.pk }}" style="font-size:20px;"> {{ experiences.title }} </a>
				 <!-- ({{ experiences.meme_set.count }} memes)-->
				  <span id="delete_album">
					<a href="{% url webapp.views.delete_album experiences.pk %}"> X</a>
				  </span>
				  <div>
					<a> with </a>
					<class id="coowner">
						{% for creator in experiences.creator.all %}
						  {% if not forloop.first %},{% endif %}<a href="/{{ creator.get_profile.url_username }}/">{{ creator.username }}</a> 
						{% endfor %}
					</class>
				  </div>
			  </span>
			</span>
			<a href="{% url webapp.views.show_experience experiences.pk %}">
			  {% if experiences.album_pic %}
			  <img src="{{ MEDIA_URL }}/{{ experiences.album_pic.image }}" class="experiences_list" id="{{ experiences.pk }}" style="height:125px;width:125px;"/>
			  {% else %}
				<img src="{{ STATIC_URL }}/images/memeja_logo.png" class="experiences_list" id="{{ experiences.pk }}" style="height:125px;width:125px;"/>
			  {% endif %}
			</a>
		  </div>
	  </span>
    {% endfor %}
  {% else %}
    No experience albums
  {% endif %}
  </div>


 <div id="uncat_container">
	<div id="upload_button_container" >
			<form action="{% url create %}" method="post" enctype="multipart/form-data">
			  {% csrf_token %}
			  {{ imageform.non_field_errors }}
			  {{ imageform.docfile.label_tag }} {{ imageform.docfile.help_text }}
			  
				{{ imageform.image.errors }}
				{{ imageform.image }}
					<span id="profile_button">
						<input type="submit" value="Upload" /></p>
					</span>
			</form>
		</div>
	<div id="uncat_header_container">
		<div id="uncat_header_text"> 
			Uncategorized 
		</div>
		<span id="uncat_header_text_addition">
		(Drag into an album)
		</span>
 
		
		<div style ="clear:both;"></div>
	 </div>

  {% if memes %}
    <div id="uncategorized">
        {% for memes in memes %}
          <div class="uncatmemes">
            <a class="fancybox" rel="group" href="{{ MEDIA_URL }}/{{ memes.image }}">
              <img src="{{ MEDIA_URL }}/{{ memes.image }}" id="{{ memes.pk }}"/>
            </a>
            <span><a href="{% url webapp.views.delete_meme memes.pk %}">X</a></span>
            {% if memes.top_caption %}
              <div><a href="/create/?meme={{ memes.pk }}">Remix</a></div>
            {% endif %}
          </div>
        {% endfor %}
    </div>
  {% endif %}

  {{ standard_js }}
{% endblock %}
